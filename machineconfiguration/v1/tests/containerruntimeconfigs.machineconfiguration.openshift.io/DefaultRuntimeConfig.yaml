apiVersion: apiextensions.k8s.io/v1 # Hack because controller-gen complains if we don't have this
name: "ContainerRuntimeConfig"
crdName: containerruntimeconfigs.machineconfiguration.openshift.io
tests:
  onCreate:
    - name: Should fail if invalid ContainerRuntimeConfig is provided
      initial: |
        apiVersion: machineconfiguration.openshift.io/v1
        kind: ContainerRuntimeConfig
        spec:  
          containerRuntimeConfig:
            defaultRuntime: docker
      expectedError: "Unsupported value: \"docker\": supported values: \"crun\", \"runc\", \"\""
    - name: Should be able to set crun in ContainerRuntimeConfig
      initial: |
        apiVersion: machineconfiguration.openshift.io/v1
        kind: ContainerRuntimeConfig
        spec:  
          containerRuntimeConfig:
            defaultRuntime: crun
      expected: |
        apiVersion: machineconfiguration.openshift.io/v1
        kind: ContainerRuntimeConfig
        spec: 
          containerRuntimeConfig:
            defaultRuntime: crun
    - name: Should be able to set runc in ContainerRuntimeConfig
      initial: |
        apiVersion: machineconfiguration.openshift.io/v1
        kind: ContainerRuntimeConfig
        spec:  
          containerRuntimeConfig:
            defaultRuntime: runc
      expected: |
        apiVersion: machineconfiguration.openshift.io/v1
        kind: ContainerRuntimeConfig
        spec: 
          containerRuntimeConfig:
            defaultRuntime: runc
